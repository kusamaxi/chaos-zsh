# oh my zsh

export ZSH="$HOME/.oh-my-zsh"
ZSH_THEME="chaos"
plugins=(git)
source $ZSH/oh-my-zsh.sh
bindkey -v

# Autoenv setup
# Lazy load autoenv only when entering a directory that contains a .env file
autoload -Uz add-zsh-hook
auto_source_venv() {
  if [[ -d .venv ]]; then
    source .venv/bin/activate
  elif [[ -d venv ]]; then
    source venv/bin/activate
  fi
}
add-zsh-hook chpwd auto_source_venv

# Custom aliases and environment variables
EDITOR=nvim
alias vi=nvim
alias lx=lsix
alias x=joshuto
alias rotko="cd ~/rotko/unlabored/"
alias config="cd ~/rotko/config/"
alias rbl='cd ~/rome/environments/ansible/'
export SSH_AUTH_SOCK=/run/user/1000/ssh-agent.socket

# PATH adjustments
export PATH=$PATH:~/.cargo/bin/:$HOME/go/bin
export PATH="$HOME/.bun/bin:$PATH"

# GPG setup
export GPG_TTY=$(tty)

# Bun completions (load only if needed)
if [ -s "$HOME/.bun/_bun" ]; then
  source "$HOME/.bun/_bun"
fi

# Load Cargo environment
. "$HOME/.cargo/env"

# Functions to improve performance
zsh_optimized_setup() {
  autoload -U compinit
  compinit -u

  autoload -U promptinit
  promptinit
}

zsh_optimized_setup
export PATH=$PATH:/usr/lib/node_modules/.bin

# bun completions
[ -s "/home/user/.bun/_bun" ] && source "/home/user/.bun/_bun"
export PATH=$HOME/.local/bin:$PATH
export XDG_RUNTIME_DIR=/run/user/1000
export PULSE_RUNTIME_PATH=/run/user/1000/pulse
